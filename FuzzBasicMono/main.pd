#N canvas 286 34 814 1225 12;
#X declare -path .;
#X obj 7 246 declare -path .;
#X obj 173 308 unpack 0 0;
#X obj 282 1171 throw~ outL;
#X obj 314 1137 throw~ outR;
#X obj 173 354 mtof;
#X obj 282 1095 voice;
#X obj 174 571 select 0;
#X msg 282 736 velocity \$1 \, on;
#X text 6 133 Note: The `voice` object is set up to receive named messages
to set parameters (frequency and velocity) and to turn on and off \,
as opposed to more directly taking note data. This seems to be a departure
from many Pd / Organelle patches \, but strikes me (@danfuzz) as a
reasonable tactic \, and one that is straightforwardly extensible for
handling both richer input as well as nontrivial voice configuration.
, f 65;
#X obj 174 532 int;
#X text 320 1 Copyright 2019 Dan Bornstein <danfuzz@milk.com>. Licensed
AS IS and WITHOUT WARRANTY under the Apache License \, Version 2.0.
Details: <http://www.apache.org/licenses/LICENSE-2.0>, f 65;
#X obj 192 388 send \$0-got-frequency;
#X obj 40 845 receive \$0-active-frequency;
#X obj 22 888 ==;
#X obj 22 926 select 1;
#X msg 22 967 off;
#X obj 423 725 receive \$0-got-frequency;
#X obj 405 773 int;
#X msg 405 855 frequency \$1;
#X obj 423 817 send \$0-active-frequency;
#X obj 22 734 int;
#X obj 22 653 bang;
#X obj 40 697 receive \$0-got-frequency;
#X text 31 793 Only turn off if the received note-off is for the frequency
that's currently playing., f 31;
#X obj 282 687 trigger float bang;
#X obj 174 418 bang;
#X obj 240 355 send \$0-got-velocity;
#X obj 192 446 receive \$0-got-velocity;
#X text 213 476 Buffer the velocity \, and only send messages to the
voice once the note number is processed. We have to do this because
we can only decide what to do (start a note \, stop a note \, or ignore
it) _after_ we know the frequency \; and Pd's right-to-left processing
nature means that the `unpack` above ends up sending the velocity _before_
the note number.;
#X text 266 638 Note-on message.;
#X text 86 624 Note-off message.;
#X text 7 65 FuzzBasicMono: Skeleton of a synth \, intended to be reasonably
structured for expansion into a more "real" synthezizer \, and _without_
distractions (such as a sequencer) which might make the structure less
apparent., f 65;
#X obj 173 276 receive notes;
#X connect 1 0 4 0;
#X connect 1 1 26 0;
#X connect 4 0 11 0;
#X connect 4 0 25 0;
#X connect 5 0 2 0;
#X connect 5 1 3 0;
#X connect 6 0 21 0;
#X connect 6 1 24 0;
#X connect 7 0 5 0;
#X connect 9 0 6 0;
#X connect 12 0 13 1;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 5 0;
#X connect 16 0 17 1;
#X connect 17 0 18 0;
#X connect 17 0 19 0;
#X connect 18 0 5 0;
#X connect 20 0 13 0;
#X connect 21 0 20 0;
#X connect 22 0 20 1;
#X connect 24 0 7 0;
#X connect 24 1 17 0;
#X connect 25 0 9 0;
#X connect 27 0 9 1;
#X connect 32 0 1 0;
