#N canvas 420 110 1260 919 12;
#X text 769 11 Copyright 2019 Dan Bornstein <danfuzz@milk.com>. Licensed
AS IS and WITHOUT WARRANTY under the Apache License \, Version 2.0.
Details: <http://www.apache.org/licenses/LICENSE-2.0>, f 65;
#X obj 285 133 inlet;
#X text 311 869 Instantaneous amplitude \, float in range [0..1].;
#X text 334 133 Message `on <velocity>` or `off <velocity>`. `<velocity>`
is float in range [0..1].;
#X obj 879 120 loadbang;
#X obj 879 194 send \$0-attack-rate;
#X obj 1027 194 send \$0-release-rate;
#X obj 1027 122 loadbang;
#X obj 285 177 route off on, f 14;
#X obj 501 342 receive \$0-attack-rate;
#X obj 448 381 pack 0 0;
#X text 518 383 Pair `[<target-value> \, <msec>]`.;
#X text 559 411 Initial `0` message to reset the line to zero \, then
a message to initiate the attack portion of the envelope., f 37;
#X obj 314 843 outlet~;
#X obj 251 355 receive \$0-release-rate;
#X obj 448 272 clip 0 1;
#X text 13 61 Simple envelope \, which is just an attack-sustain-release
with fixed slopes. `on` velocity becomes the full amplitude value \,
and `off` velocity is ignored.;
#X obj 156 389 expr $f1 * $f2;
#X msg 156 422 0 \$1;
#X obj 145 713 send~ \$0-to-snapshot;
#X obj 156 270 bang;
#X obj 156 342 snapshot~;
#X obj 182 304 receive~ \$0-to-snapshot;
#X obj 314 616 line~ 0;
#X text 937 80 Fixed Parameters;
#X floatatom 879 157 6 0 10000 0 - - -;
#X floatatom 1027 157 6 0 10000 0 - - -;
#X msg 448 415 0 \, \$1 \$2, f 13;
#X text 843 220 These are slopes represented as the number of msec
to go from 0 to 1 (or back). Notably \, these are _not_ the number
of msec to perform an attack or release \, as that would (for example)
make all attacks and releases take the same amount of time (despite
velocity differences) and also make a release-from-mid-attack take
the wrong amount of time., f 53;
#X text 5 733 The `release-rate` value is a rate not an absolute number
of msec (see comment at definition site) \, so snapshot the amplitude
at the moment of release initiation \, and use it to calculate the
correct ramp-down time., f 41;
#X connect 1 0 8 0;
#X connect 4 0 25 0;
#X connect 7 0 26 0;
#X connect 8 0 20 0;
#X connect 8 1 15 0;
#X connect 9 0 10 1;
#X connect 10 0 27 0;
#X connect 14 0 17 1;
#X connect 15 0 10 0;
#X connect 17 0 18 0;
#X connect 18 0 23 0;
#X connect 20 0 21 0;
#X connect 21 0 17 0;
#X connect 22 0 21 0;
#X connect 23 0 13 0;
#X connect 23 0 19 0;
#X connect 25 0 5 0;
#X connect 26 0 6 0;
#X connect 27 0 23 0;
