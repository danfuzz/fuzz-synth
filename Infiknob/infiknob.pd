#N canvas 667 32 1373 1013 12;
#X text 896 10 Copyright 2019 Dan Bornstein <danfuzz@milk.com>. Licensed
AS IS and WITHOUT WARRANTY under the Apache License \, Version 2.0.
Details: <http://www.apache.org/licenses/LICENSE-2.0>, f 65;
#X obj 1232 194 float \$1;
#X obj 1170 249 float \$2;
#X obj 1108 311 float \$3;
#X obj 1108 336 value quant\$0;
#X obj 1170 274 value max\$0;
#X obj 1232 219 value min\$0;
#X obj 1046 155 trigger bang bang bang bang;
#X obj 1046 112 loadbang;
#X text 997 82 Contructor arguments / initial values;
#X obj 1136 461 expr (min\$0 + max\$0) / 2;
#X obj 1130 548 value frozen\$0;
#X obj 316 228 inlet;
#X obj 1043 428 receive \$0-reset;
#X obj 1046 369 send \$0-reset;
#X obj 207 917 expr max(min($f1 \, max\$0) \, min\$0);
#X obj 207 976 outlet;
#X obj 207 858 receive \$0-to-outlet;
#X obj 165 443 trigger bang bang;
#X obj 281 475 send \$0-reset;
#X obj 207 947 change;
#X text 459 891 Round to the quantization increment.;
#X text 458 918 Clip to the limits.;
#X obj 207 888 expr rint($f1 / quant\$0) * quant\$0;
#X obj 1112 606 value midincs\$0;
#X text 715 666 Auto-increment section;
#X obj 557 475 send \$0-reset;
#X obj 399 442 trigger bang float bang;
#N canvas 487 290 1038 808 auto-increment 0;
#X text 489 466 Convert to increment per 50msec (1/20 sec).;
#X obj 380 465 expr $f1 / 20;
#X obj 75 667 +;
#X obj 19 82 inlet;
#X text 10 34 Toggle auto-increment (`0` to turn it off \, `1` to turn
it on)., f 32;
#X obj 412 82 inlet;
#X obj 19 188 select 0;
#X msg 19 227 stop;
#X msg 142 227 bang;
#X text 372 7 Amount of auto-increment. Float in range [-1..1] to indicate
how far from center the control is and in which direction. The further
away from center \, the faster the rate of change., f 49;
#X obj 75 751 outlet;
#X obj 347 751 outlet;
#X text 60 775 Value to send to the main outlet.;
#X text 332 776 New center value.;
#X obj 19 151 change;
#X text 118 119 Ensure boolean...;
#X text 71 151 ...and only touch the `metro` when it changes., f 31
;
#X obj 70 264 metro 50;
#X obj 19 118 expr $f1 != 0;
#X obj 617 254 receive \$0-reset-limiter;
#X obj 617 390 value inclimit\$0;
#X obj 142 264 send \$0-reset-limiter;
#X obj 664 325 value inclimitmax\$0;
#X obj 617 359 expr quant\$0 * 2;
#X text 740 410 Limit the increment per second to a multiple of quanta
\, which itself increases exponentially over time., f 39;
#X obj 380 388 float;
#X obj 103 314 trigger bang bang;
#X text 429 497 The first expression here calculates the new center
value. The second one emits the offset from center based on the current
direction of travel. These flow into an adder below \, to produce the
final value output.;
#X obj 75 504 expr max(min(center\$0 + $f2 \, max\$0) \, min\$0) \;
if($f2 < 0 \, -1 \, 1) * midincs\$0 / 2 * quant\$0;
#X text 422 154 Increment per second \, set up as exponentially increasing
in magnitude as the control moves away from center. This gets stored
in the `float` below \, for calculation of instantaneous actual rate
with each bang of the `metro`., f 54;
#X obj 664 293 expr (max\$0 - min\$0) / 2;
#X obj 412 122 expr copysign(pow((max\$0 - min\$0) / 4 \, abs($f1))
\, $f1), f 30;
#X obj 380 420 expr copysign(min(abs($f1) \, inclimit\$0) \, $f1) \;
inclimit\$0 = min(inclimit\$0 * 1.09 \, inclimitmax\$0);
#X connect 1 0 28 1;
#X connect 2 0 10 0;
#X connect 3 0 18 0;
#X connect 5 0 31 0;
#X connect 6 0 7 0;
#X connect 6 1 8 0;
#X connect 7 0 17 0;
#X connect 8 0 17 0;
#X connect 8 0 21 0;
#X connect 14 0 6 0;
#X connect 17 0 26 0;
#X connect 18 0 14 0;
#X connect 19 0 23 0;
#X connect 19 0 30 0;
#X connect 23 0 20 0;
#X connect 25 0 32 0;
#X connect 26 0 28 0;
#X connect 26 1 25 0;
#X connect 28 0 2 0;
#X connect 28 0 11 0;
#X connect 28 1 2 1;
#X connect 30 0 22 0;
#X connect 31 0 25 1;
#X connect 32 0 1 0;
#X restore 674 763 pd auto-increment;
#X obj 674 827 send \$0-to-outlet;
#X obj 790 801 value center\$0;
#X obj 790 724 receive \$0-auto-amt;
#X text 13 8 "Infinite" range knob. See `README.md` for details.,
f 52;
#X obj 478 500 value center\$0;
#X obj 1136 488 value center\$0;
#X text 14 31 Constructor arguments (in order): `min\$0` -- minimum
value in the output range \; `max\$0` -- maximum value in the output
range \; `quant\$0` -- increment quantum (smallest possible increment
_and_ the quantized alignment), f 82;
#X text 13 191 Constants: `midincs\$0` -- The number of increments
(steps) in the center range of the control input., f 82;
#N canvas 1475 350 1006 730 control-input 0;
#X obj 290 32 inlet;
#X text 339 31 Input control value;
#X obj 55 646 outlet;
#X obj 290 87 moses -0.5;
#X obj 424 148 moses 0.50001;
#X obj 345 449 expr center\$0 + ($f1 * quant\$0);
#X obj 345 352 trigger float bang;
#X obj 57 170 trigger bang float;
#X obj 692 213 trigger bang float;
#X obj 345 419 expr rint($f1 * midincs\$0);
#X obj 815 267 expr min(1 \, ($f1 - 0.5) * 2 + 0.01), f 20;
#X obj 180 225 expr max(-1 \, ($f1 + 0.5) * 2 - 0.01), f 22;
#X obj 318 646 outlet;
#X text 316 672 Toggle (boolean) for auto-increment;
#X text 618 670 Auto-increment amount;
#X obj 617 643 outlet;
#X obj 617 601 receive \$0-ctl-auto-amt;
#X obj 815 310 send \$0-ctl-auto-amt;
#X obj 180 268 send \$0-ctl-auto-amt;
#X msg 297 597 1;
#X msg 336 597 0;
#X obj 297 541 receive \$0-ctl-auto-on;
#X obj 336 568 receive \$0-ctl-auto-off;
#X text 52 672 Value to send to the main outlet;
#X obj 692 344 send \$0-ctl-auto-on;
#X obj 57 301 send \$0-ctl-auto-on;
#X obj 468 382 send \$0-ctl-auto-off;
#X text 12 99 Lower input range: auto-decrement.;
#X text 611 174 Upper input range: auto-increment.;
#X text 541 413 Convert control value to number of quanta up/down from
the center value., f 41;
#X text 396 232 Middle input range: quantized absolute control around
current center value., f 38;
#X connect 0 0 3 0;
#X connect 3 0 7 0;
#X connect 3 1 4 0;
#X connect 4 0 6 0;
#X connect 4 1 8 0;
#X connect 5 0 2 0;
#X connect 6 0 9 0;
#X connect 6 1 26 0;
#X connect 7 0 25 0;
#X connect 7 1 11 0;
#X connect 8 0 24 0;
#X connect 8 1 10 0;
#X connect 9 0 5 0;
#X connect 10 0 17 0;
#X connect 11 0 18 0;
#X connect 16 0 15 0;
#X connect 19 0 12 0;
#X connect 20 0 12 0;
#X connect 21 0 19 0;
#X connect 22 0 20 0;
#X restore 674 519 pd control-input;
#X obj 674 618 send \$0-to-outlet;
#X obj 728 589 send \$0-auto-toggle;
#X obj 674 692 receive \$0-auto-toggle;
#X obj 783 561 send \$0-auto-amt;
#N canvas 1172 526 763 681 freeze-handler 0;
#X obj 28 140 inlet;
#X obj 181 139 inlet;
#X text 27 113 Input control value;
#X text 178 113 Boolean: currently frozen?;
#X obj 297 586 outlet;
#X obj 89 202 pack 0 0;
#X text 498 113 Value to output if still frozen;
#X obj 500 140 inlet;
#X text 295 611 New frozen flag;
#X obj 69 584 outlet;
#X obj 468 585 outlet;
#X obj 68 547 float;
#X msg 40 495 bang;
#X text 63 609 Input control to pass along if unfrozen, f 23;
#X msg 443 489 bang;
#X obj 468 549 float;
#X obj 89 384 select 0;
#X text 462 614 Value to send to main output if still frozen., f 32
;
#X text 13 9 This sub-object handles the work of keeping the control
"frozen" until the input passes into / near the center of the range
\, at which point it becomes unfrozen. This sub-object is "pure" (doesn't
use or store variables) \; instead its use site arranges for the appropriate
state update.;
#X obj 89 246 expr $f2 && (($f1 < -0.1) || ($f1 > 0.1));
#X connect 0 0 5 0;
#X connect 0 0 11 1;
#X connect 1 0 5 1;
#X connect 5 0 19 0;
#X connect 7 0 15 1;
#X connect 11 0 9 0;
#X connect 12 0 11 0;
#X connect 14 0 15 0;
#X connect 15 0 10 0;
#X connect 16 0 12 0;
#X connect 16 1 14 0;
#X connect 19 0 4 0;
#X connect 19 0 16 0;
#X restore 674 426 pd freeze-handler;
#X obj 710 379 value frozen\$0;
#X obj 732 480 value frozen\$0;
#X obj 631 336 trigger float bang bang;
#X obj 828 379 value center\$0;
#X obj 790 457 send \$0-to-outlet;
#X msg 1089 635 0;
#X obj 1089 663 send \$0-auto-toggle;
#X msg 1130 521 1;
#X msg 1112 579 50;
#X obj 367 639 expr center\$0;
#X obj 367 671 send \$0-to-outlet;
#X obj 316 272 route bang reset set;
#X obj 45 856 receive \$0-reoutput;
#X msg 45 889 bang;
#X obj 47 350 send \$0-reoutput;
#X text 13 99 Local variables: `center\$0` -- current center of the
control range \; `frozen\$0` -- boolean indicating whether the control
is "frozen" (starts frozen upon initialization and becomes unfrozen
once the input control is moved to near the center of its range) \;
`inclimit\$0` and `inclimitmax\$0` (used in the auto-increment sub-object)
-- limits on the rate of change of the output., f 82;
#X connect 1 0 6 0;
#X connect 2 0 5 0;
#X connect 3 0 4 0;
#X connect 7 0 14 0;
#X connect 7 1 3 0;
#X connect 7 2 2 0;
#X connect 7 3 1 0;
#X connect 8 0 7 0;
#X connect 10 0 34 0;
#X connect 12 0 54 0;
#X connect 13 0 10 0;
#X connect 13 0 48 0;
#X connect 13 0 50 0;
#X connect 13 0 51 0;
#X connect 15 0 20 0;
#X connect 17 0 23 0;
#X connect 18 0 52 0;
#X connect 18 1 19 0;
#X connect 20 0 16 0;
#X connect 23 0 15 0;
#X connect 27 0 52 0;
#X connect 27 1 33 0;
#X connect 27 2 26 0;
#X connect 28 0 29 0;
#X connect 28 1 30 0;
#X connect 31 0 28 1;
#X connect 37 0 38 0;
#X connect 37 1 39 0;
#X connect 37 2 41 0;
#X connect 40 0 28 0;
#X connect 42 0 37 0;
#X connect 42 1 44 0;
#X connect 42 2 47 0;
#X connect 43 0 42 1;
#X connect 45 0 42 0;
#X connect 45 1 43 0;
#X connect 45 2 46 0;
#X connect 46 0 42 2;
#X connect 48 0 49 0;
#X connect 50 0 11 0;
#X connect 51 0 24 0;
#X connect 52 0 53 0;
#X connect 54 0 57 0;
#X connect 54 1 18 0;
#X connect 54 2 27 0;
#X connect 54 3 45 0;
#X connect 55 0 56 0;
#X connect 56 0 20 0;
